
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>HashJoin &mdash; HYRISE latest documentation</title>
    
    <link rel="stylesheet" href="../../../_static/flasky.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/breathe.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     'latest',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <link rel="top" title="HYRISE latest documentation" href="../../../index.html" />
    <link rel="up" title="Plan Operations" href="../planops.html" />
    <link rel="next" title="Extension points" href="../extension_points.html" />
    <link rel="prev" title="Group By Scan" href="groupby.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  <link rel="stylesheet" href="../../../_static/bootstrap.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/hyrise_template.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/hyrise.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/hyrise-pygments.css" type="text/css" />

  <script src="../../../_static/jquery-1.9.1.js"></script>
  <script src="../../../_static/jquery-fix.js"></script>
  <script src="../../../_static/bootstrap.js"></script>
  <script src="../../../_static/layouting.js"></script>

  </head>
  <body>
  
  

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../extension_points.html" title="Extension points"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="groupby.html" title="Group By Scan"
             accesskey="P">previous</a> |</li>
        <li><a href="../../../contents.html">HYRISE latest documentation</a> &raquo;</li>
          <li><a href="../index.html" >Implementation Details</a> &raquo;</li>
          <li><a href="../planops.html" accesskey="U">Plan Operations</a> &raquo;</li> 
      </ul>
    </div>
  <div class="wrapper">
    <div class="inner-wrapper">
        <div class="container"><div class="navbar-wrapper">
  <nav class="navbar navbar-default navbar-fixed-top container" role="navigation" id="menu">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse navbar-ex1-collapse">
      <ul class="nav navbar-nav topnav">
        <li><a href="../../../index.html">Home</a></li>
        <li class="active" ><a href="../../index.html">Documentation</a></li>
        <li><a href="../../../people.html">People</a></li>
        <!-- <li><a href="../../../projects.html">Projects</a></li> -->
        <li><a href="../../../publications.html">Publications</a></li>
      </ul>

      <h1>HashJoin</h1>
    </div><!-- /.navbar-collapse -->
  </nav>
</div>
            <div class="row upper">
              
  <div class="col-md-3">
    <div class="hyrisesidebar nav">
  <h3><a href="../../../contents.html">Contents</a></h3>
  <div class='localtoc'>
	<ul>
<li><a class="reference internal" href="#">HashJoin</a><ul>
<li><a class="reference internal" href="#build-phase-hashbuild">Build Phase: HashBuild</a></li>
<li><a class="reference internal" href="#probe-phase-hashjoinprobe">Probe Phase: HashJoinProbe</a></li>
</ul>
</li>
</ul>

  </div><h3>Related Topics</h3>
<ul>
  <li><a href="../../../contents.html">Documentation overview</a><ul>
  <li><a href="../index.html">Implementation Details</a><ul>
  <li><a href="../planops.html">Plan Operations</a><ul>
      <li>Previous: <a href="groupby.html" title="previous chapter">Group By Scan</a></li>
      <li>Next: <a href="../extension_points.html" title="next chapter">Extension points</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../../../_sources/documentation/architecture/planops/hashjoin.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
    </div>
  </div>
              <div class="col-md-9" role="main">
                
  <div class="section" id="hashjoin">
<h1>HashJoin<a class="headerlink" href="#hashjoin" title="Permalink to this headline">¶</a></h1>
<p>HYRISE&#8217; HashJoin implementation is divided into a build and probe phase.</p>
<div class="section" id="build-phase-hashbuild">
<h2>Build Phase: HashBuild<a class="headerlink" href="#build-phase-hashbuild" title="Permalink to this headline">¶</a></h2>
<p>For the first phase, the build phase, the HashBuild PlanOperation is used. It accepts the first AbstractTable and a list of fields as input to produce a HashTable:</p>
<div class="highlight-c"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre>      <span class="kt">void</span> <span class="n">HashBuild</span><span class="o">::</span><span class="n">executePlanOperation</span><span class="p">()</span>
      <span class="p">{</span>
              <span class="n">addResult</span><span class="p">(</span><span class="n">new</span> <span class="n">HashTable</span><span class="p">(</span>
                      <span class="n">getInputTable</span><span class="p">(),</span>
                      <span class="n">new</span> <span class="kt">field_list_t</span><span class="p">(</span><span class="n">_field_definition</span><span class="p">)));</span>
      <span class="p">}</span>

      <span class="n">HashTable</span><span class="p">(</span><span class="n">AbstractTable</span> <span class="o">*</span><span class="n">table</span><span class="p">,</span> <span class="kt">field_list_t</span> <span class="o">*</span><span class="n">fields</span><span class="p">)</span>
      <span class="p">{</span>
              <span class="k">for</span> <span class="p">(</span><span class="kt">pos_t</span> <span class="n">row</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="n">table</span><span class="o">-&gt;</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">row</span><span class="p">)</span>
              <span class="p">{</span>
                      <span class="n">add</span><span class="p">(</span><span class="n">hashFor</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="o">*</span><span class="n">fields</span><span class="p">,</span> <span class="n">row</span><span class="p">),</span> <span class="n">row</span><span class="p">);</span>
              <span class="p">}</span>
      <span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>To build the HashTable, the cell values of all table&#8217;s rows in the specified fields are hashed together. They are stored in a multimap, mapping onto all rows containing identical groups of cell values. This provides a fast way to look up rows belonging to a set of cell values.</p>
</div>
<div class="section" id="probe-phase-hashjoinprobe">
<h2>Probe Phase: HashJoinProbe<a class="headerlink" href="#probe-phase-hashjoinprobe" title="Permalink to this headline">¶</a></h2>
<p>In the second phase, the HashJoinProbe PlanOperation is used. It accepts the second AbstractTable and the aforementioned HashTable as input to produce the resulting joined table:</p>
<div class="highlight-c"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre></div></td><td class="code"><div class="highlight"><pre>      <span class="kt">void</span> <span class="n">HashJoinProbe</span><span class="o">::</span><span class="n">fetchPositions</span><span class="p">(</span>
              <span class="kt">pos_list_t</span> <span class="o">*</span><span class="n">buildTablePosList</span><span class="p">,</span>
              <span class="kt">pos_list_t</span> <span class="o">*</span><span class="n">probeTablePosList</span><span class="p">)</span>
      <span class="p">{</span>
              <span class="n">AbstractTable</span> <span class="o">*</span><span class="n">probeTable</span> <span class="o">=</span> <span class="n">getProbeTable</span><span class="p">();</span>
              <span class="k">for</span> <span class="p">(</span><span class="kt">pos_t</span> <span class="n">probeTableRow</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">probeTableRow</span> <span class="o">&lt;</span> <span class="n">probeTable</span><span class="o">-&gt;</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">probeTableRow</span><span class="p">)</span>
              <span class="p">{</span>
                      <span class="kt">pos_list_t</span> <span class="o">*</span><span class="n">buildTableMatchingRows</span> <span class="o">=</span> <span class="n">getInputHashTable</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">get</span><span class="p">(</span>
                              <span class="n">probeTable</span><span class="p">,</span>
                              <span class="n">_field_definition</span><span class="p">,</span>
                              <span class="n">probeTableRow</span><span class="p">);</span>
                      <span class="k">if</span> <span class="p">(</span><span class="n">buildTableMatchingRows</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">)</span>
                      <span class="p">{</span>
                              <span class="n">BOOST_FOREACH</span><span class="p">(</span><span class="kt">pos_t</span> <span class="n">buildTableRow</span><span class="p">,</span> <span class="o">*</span><span class="n">buildTableMatchingRows</span><span class="p">)</span>
                              <span class="p">{</span>
                                      <span class="n">buildTablePosList</span><span class="o">-&gt;</span><span class="n">push_back</span><span class="p">(</span><span class="n">buildTableRow</span><span class="p">);</span>
                                      <span class="n">probeTablePosList</span><span class="o">-&gt;</span><span class="n">push_back</span><span class="p">(</span><span class="n">probeTableRow</span><span class="p">);</span>
                              <span class="p">}</span>
                      <span class="p">}</span>
              <span class="p">}</span>
      <span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>During execution, HashJoinProbe hashes the table&#8217;s cell values of the specified row together on the fly while iterating over the table. For each calculated hash, a lookup on the HashTable is performed to fetch matching rows of the first table. Pairs of matching rows are stored in the resulting joined table.</p>
</div>
</div>


              </div>
            </div>
            <div class="row footer_toc">
<!--   <h3><a href="../../../contents.html">Contents</a></h3> -->
<div class="col-md-offset-1 col-md-3">
  <div class='toc-general'>
  	<h3>Navigation</h3>
	<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../index.html">HYRISE introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../people.html">People</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../publications.html">Publications</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Implementation Details</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gettingstarted/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../queryexecution/index.html">HYRISE Query Execution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developing/index.html">Developing with HYRISE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq/index.html">HYRISE &amp; Development FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../proposals/index.html">Proposals</a></li>
</ul>

  </div>
</div>
<div class="col-md-7">
	<h3>License</h3>
	HYRISE is licensed as open source after the OpenSource “Licence of the Hasso-Plattner Institute” declared in the LICENSE file of this project.

	Question: Why does HYRISE not use MIT or BSD or XX license. The reason for our approach comes with the German copyright law. Common BSD and MIT licenses are not necessarily compatible and thus can potentially lead to problems. To overcome this problem this project uses an specifically designed open source license to be compatible with German law. The most prominent difference is the exclusion of all liabilities which is not possible in Germany.

	<h3>Copyright</h3>
    &copy; 2010-2013, Martin Grund et al.
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>.

</div>
            </div>
        </div>
      </div>
    </div>
  </div>



  </body>
</html>